# IS IT AN RSA??? (Cryptography) - Digital Defenders 2023

## Description
> The enigmatic Cyber Ninja clan devised an extraordinary encryption technique known as the RSA Art of Shadows.
>
> In this ancient cryptographic art, every element is intricately interconnected, embodying the essence of their mystical power. Legend speaks of a forbidden connection between n3, the sacred modulus of the third level, and the elusive shuriken factor, s.
>
> The Cyber Ninjas now question the resilience of their moduli amidst the shadows of uncertainty. Unravel this enigma and reveal the extent of the moduli's vulnerability to achieve enlightenment

> **FLAG FORMAT:** flag{}

> **HINT:**
> 1. Try taking a look at the bit lengths.

## Files
1. chall.py
2. cipher.txt

## Initial Takeaway
Judging by the title, the challenge obviously has something to do with the RSA encryption, and since the way it's framed, the challenge is to figure out if it really forms an RSA encryption or not.

The contents of chall.py
```python3
from Crypto.Util.number import getPrime

p = getPrime(1024)
q = getPrime(1024)
r = getPrime(1024)
s = getPrime(1024)

m = #REDACTED
n1 = p*q
n2 = q*r
n3 = #REDACTED
e = 65537
c = pow(m,e,n3)

with open("cipher.txt","w") as f1:
    f1.write("n1 : {n1}\nn2 : {n2}\nn3 : {n3}\nc : {c}")
```

And, the contents of cipher.txt
```
n1 : 2091291005079603183080967397767445585739332009611347100010847659823967182329045
453909950500634118192780339623000233873545440164640647591268821892310436010149342058
746407027332352756726611308562062977718223027264901607903403582619360694171740991112
729303393751112723262202538326774801877497141507123211268251808546525367778607588238
875125290375888582233520104878303360705912511412972196223703184816025784004274960470
166135110463219726810133835658515299320049984722414842827628528094771302584159447292
445933081447579651969149659897636622468122718305794407836798864666998388751138671230
0733007180288701194351474709451461
n2 : 2387242693256388391490198323169236380598307052033100244744505071552497225158649
780057175655946472192454936208440649454728048696248751174691282837349788752144069932
972318218540303788971653374518347952565018498330116118319586076672364298906846283233
594933213936017710935324670988613060727546961682982937768838910187559169303972127025
849164173669589176927933190185514527697771330783942634083980440596855806684431640303
898567929556234237950578457599496768095985506664134871102184462146098424950278386293
434128714201901618259795956253501518359058394293721542215866972316024449419424246027
9136853725071235733665302988209581
n3 : 6232655486251632785100224879955678768909265332093089993703303623714392853050854
126154567095723006104697647093335294068344196382616019832770557306343651162684948518
902979108282949588096808351450623743346601449250738170091533631943562779720038234298
250906875778841048037724234945596602729659424156568460934214977187893990579236324524
609593290046426594164015334947346743412973340921852694562446491672941487569981829263
814862636806570180868616950003904773342986520895100627860914834749470314023754759348
196583932314556282070751096072105716299644565817533342270771616489689744737320632972
591938693724941403485138931864410545300817865884949780998209392948086026493035438077
259720180355612869980031805245197403271921050761942505315950886782965594269057376048
984873325062637684480083702909283169658772526575919814732920676317787800639494331868
335970227361005962429278814451733975337190636819330236906424982871470122885696482807
762376796672552721127103308874077716831458391119616027211607261807351953552376902490
907228027129298994251759425611469085935855564413254999800358383171703544790815023401
120915308978688554957577389339242569698792095488440983927559563407979056884585711591
056333255586830591683310411508801603417762297188606122532776893835921359548178203569
936371536938070886189713093578524200775530444536632642890815444066974402685775430193
194061365388224207676804301768628312054430496242220489323344574067357451455227890269
125738949253846492500214470018610562861567297313811186540524245550451943322654015474
666871290696933489197294726486036042077059671973587472343955783817974871618422863116
015210516144431364094265496737449945671866732594102641387560183287045199238281302192
09915417334306742146661470932320976746278374554809658219190409161811156640039813265447320394905627416336825499242467352625072411979139565787153117666316266128433664263573908420103316680637158744227670026017618721163233170430817916291320917442601841215726738107837455010696286492216875918830651149525869473057392158941139946159965059088434640307636983388935709069356519776673061113986935201719486791353927766209797128863955945018524614009681587930678131170189431123293320603504946629
c : 300765675631036702440523739351154897383328322310909427639150819891961020790689307369308441255403094732423274431969874729576538743620119420735510045406001994753894520763272198722820558323777418995706994461414667818537719413094635232811184202577172511003889024565202258024532325841442524255115720343283468219385208657431547944302686466963643630617734585172811247868088027325004294939532871542424327865040876468978611871974999372691163464294756117812578408540739824709677959432355997425868877804980417752642107595057064248851537732058086278189683557116314198234770298192400203155340277871276718988519131085372705342068348850422546040347545294934795160228629715928205702963059053926678039307251970985067503945484142259384931005122474633734569350468028096545310923922736277126500494960558901118391826970750599017736592975695396953268648137731306315298363276952213929906449212672277952655169301409708326657804508222562820866018885085111020645767177241778007313870356313737766211807671684466236765782369978681732347669091529835873174707088943878081394207743832495916408484710683636315373611964455948879147334744259927601718737189225141948942454372275019801444709829300827100970958900715300313378107547518939050666002906010324615404445192022240280315907630458853581194336155758396621241419237953860938727690588816954526361793957917189783860306310822734347040467227916427155488984237263951334309867259192368643799454225026080500451877047304229273388998226482371462690188525788808790286231420310667434427953649009749851835345643678202026126838640308587587491539165176588320928304857832498694961323661593475151903835366820810227102061312419087294682432081917413904639688299669590743900799344326135311955543328076735324152278029826551922472334486502065676931796120276566197522523087325802268044548699688695109433084891340455120679761061711197620052128458728329181321749503305859230167473247286327332162638070885298897162507611749649393208158266253582200354380719427286181196920627292677984198089607982851981186674993709576820550096457875619124681598635713218705170000750192136641170764054753456395228025468183484945388029949429676193689771416723243948217122509236756623
```

## Execution
`chall.txt` had the following details
```
ğ‘¬ğ’ğ’”ğ’–ğ’“ğ’† ğ’•ğ’‰ğ’† ğ’„ğ’ğ’Šğ’†ğ’ğ’•'ğ’” ğ’”ğ’†ğ’„ğ’–ğ’“ğ’Šğ’•ğ’š ğ’‚ğ’• ğ’‚ğ’ğ’ ğ’•ğ’Šğ’ğ’†ğ’”
 
agin{afkkxf_7e3_ib4d}

ğ‘´ğ’ğ’…ğ’†ğ’ : ğ‘´3
ğ‘¹ğ’†ğ’‡ğ’ğ’†ğ’„ğ’•ğ’ğ’“ : ğ‘¼ğ‘²ğ‘¾ ğ‘©

ğ‘¹ğ‘¶ğ‘»ğ‘¶ğ‘¹ 1 : ğ‘½ğ‘°
ğ‘·ğ’ğ’”ğ’Šğ’•ğ’Šğ’ğ’ : 1ğ‘¨
ğ‘¹ğ’Šğ’ğ’ˆ : 2ğ‘©

ğ‘¹ğ‘¶ğ‘»ğ‘¶ğ‘¹ 2 : ğ‘°
ğ‘·ğ’ğ’”ğ’Šğ’•ğ’Šğ’ğ’ : 3ğ‘ª
ğ‘¹ğ’Šğ’ğ’ˆ : 4ğ‘«

ğ‘¹ğ‘¶ğ‘»ğ‘¶ğ‘¹ 3 : ğ‘°ğ‘°ğ‘°
ğ‘·ğ’ğ’”ğ’Šğ’•ğ’Šğ’ğ’ : 5ğ‘¬
ğ‘¹ğ’Šğ’ğ’ˆ : 6ğ‘­

ğ‘·ğ‘³ğ‘¼ğ‘®ğ‘©ğ‘¶ğ‘¨ğ‘¹ğ‘« : ğ’ƒğ’’ ğ’„ğ’“ ğ’…ğ’Š ğ’†ğ’‹ ğ’Œğ’˜ ğ’ğ’• ğ’ğ’” ğ’‘ğ’™ ğ’–ğ’› ğ’ˆğ’‰
```
So, I headed over to [](https://cryptii.com/pipes/enigma-machine) to solve this challenge.

I entered the values as mentioned
  
![image](https://github.com/ghost-1608/CTF-Write-Ups/assets/64543976/2f5b8fdc-3cae-4e24-8c81-218836b722a8)

And thus got the flag.

**FLAG:** `flag{wojtek_7h3_be4r}`
